// <auto-generated>
//     此代码由代码生成器生成，请勿手动修改
//     生成时间: 2025-11-20 21:13:12
// </auto-generated>

using System.Collections.Generic;
using System.Linq;
using Orleans;

namespace FakeMicro.Interfaces.Models
{
    /// <summary>
    /// 验证结果类
    /// </summary>
    [GenerateSerializer]
    public class ValidationResult : BaseResultModel
    {
        /// <summary>
        /// 验证错误列表
        /// </summary>
        [Id(1)]
        public List<string> Errors { get; set; } = new List<string>();

        /// <summary>
        /// 验证警告列表
        /// </summary>
        [Id(2)]
        public List<string> Warnings { get; set; } = new List<string>();

        /// <summary>
        /// 是否通过验证
        /// </summary>
        [Id(3)]
        public bool IsValid { get; set; }

        /// <summary>
        /// 验证的字段数量
        /// </summary>
        [Id(4)]
        public int ValidatedFieldCount { get; set; }

        /// <summary>
        /// 创建成功的验证结果
        /// </summary>
        /// <param name="validatedFieldCount">验证的字段数量</param>
        /// <returns>ValidationResult</returns>
        public static ValidationResult CreateSuccess(int validatedFieldCount = 0)
        {
            return new ValidationResult
            {
                Success = true,
                IsValid = true,
                ValidatedFieldCount = validatedFieldCount
            };
        }

        /// <summary>
        /// 创建失败的验证结果
        /// </summary>
        /// <param name="errors">错误列表</param>
        /// <param name="warnings">警告列表</param>
        /// <returns>ValidationResult</returns>
        public static ValidationResult CreateFailed(List<string> errors, List<string>? warnings = null)
        {
            return new ValidationResult
            {
                Success = false,
                IsValid = false,
                Errors = errors ?? new List<string>(),
                Warnings = warnings ?? new List<string>()
            };
        }

        /// <summary>
        /// 添加错误信息
        /// </summary>
        /// <param name="error">错误信息</param>
        public void AddError(string error)
        {
            if (!string.IsNullOrWhiteSpace(error))
            {
                Errors.Add(error);
            }
        }

        /// <summary>
        /// 添加多个错误信息
        /// </summary>
        /// <param name="errors">错误信息列表</param>
        public void AddErrors(IEnumerable<string> errors)
        {
            if (errors != null)
            {
                Errors.AddRange(errors.Where(e => !string.IsNullOrWhiteSpace(e)));
            }
        }

        /// <summary>
        /// 添加警告信息
        /// </summary>
        /// <param name="warning">警告信息</param>
        public void AddWarning(string warning)
        {
            if (!string.IsNullOrWhiteSpace(warning))
            {
                Warnings.Add(warning);
            }
        }

        /// <summary>
        /// 添加多个警告信息
        /// </summary>
        /// <param name="warnings">警告信息列表</param>
        public void AddWarnings(IEnumerable<string> warnings)
        {
            if (warnings != null)
            {
                Warnings.AddRange(warnings.Where(w => !string.IsNullOrWhiteSpace(w)));
            }
        }

        /// <summary>
        /// 获取所有错误信息
        /// </summary>
        /// <returns>错误信息字符串</returns>
        public string GetAllErrors()
        {
            return string.Join("; ", Errors);
        }

        /// <summary>
        /// 获取所有警告信息
        /// </summary>
        /// <returns>警告信息字符串</returns>
        public string GetAllWarnings()
        {
            return string.Join("; ", Warnings);
        }

        /// <summary>
        /// 获取错误和警告的摘要信息
        /// </summary>
        /// <returns>摘要信息</returns>
        public string GetSummary()
        {
            if (IsValid)
            {
                return $"验证通过 (验证字段: {ValidatedFieldCount})";
            }

            var summary = $"验证失败 - 错误: {Errors.Count} 个";
            if (Warnings.Count > 0)
            {
                summary += $", 警告: {Warnings.Count} 个";
            }
            return summary;
        }
    }
}